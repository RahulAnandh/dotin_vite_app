import { createSlice } from "@reduxjs/toolkit";

export const bookingSlice = createSlice({
  name: "booking",
  initialState: {
    seatData: [
      [
        {
          id: 1,
          identifier: "A1",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 2,
          identifier: "A2",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 3,
          identifier: "A3",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 4,
          identifier: "A4",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 5,
          identifier: "A5",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 6,
          identifier: "A6",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 7,
          identifier: "A7",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 8,
          identifier: "A8",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 9,
          identifier: "A9",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 10,
          identifier: "A10",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
      ],
      [
        {
          id: 11,
          identifier: "B1",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 12,
          identifier: "B2",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 13,
          identifier: "B3",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 14,
          identifier: "B4",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 15,
          identifier: "B5",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 16,
          identifier: "B6",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 17,
          identifier: "B7",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 18,
          identifier: "B8",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 19,
          identifier: "B9",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
        {
          id: 20,
          identifier: "B10",
          tire: "Silver",
          clickable: true,
          selected: false,
        },
      ],
      [
        {
          id: 21,
          identifier: "C1",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 22,
          identifier: "C2",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 23,
          identifier: "C3",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 24,
          identifier: "C4",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 25,
          identifier: "C5",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 26,
          identifier: "C6",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 27,
          identifier: "C7",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 28,
          identifier: "C8",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 29,
          identifier: "C9",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 30,
          identifier: "C10",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
      ],
      [
        {
          id: 31,
          identifier: "D1",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 32,
          identifier: "D2",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 33,
          identifier: "D3",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 34,
          identifier: "D4",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 35,
          identifier: "D5",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 36,
          identifier: "D6",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 37,
          identifier: "D7",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 38,
          identifier: "D8",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 39,
          identifier: "D9",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
        {
          id: 40,
          identifier: "D10",
          tire: "Gold",
          clickable: true,
          selected: false,
        },
      ],
      [
        {
          id: 41,
          identifier: "E1",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 42,
          identifier: "E2",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 43,
          identifier: "E3",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 44,
          identifier: "E4",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 45,
          identifier: "E5",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 46,
          identifier: "E6",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 47,
          identifier: "E7",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 48,
          identifier: "E8",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 49,
          identifier: "E9",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 50,
          identifier: "E10",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
      ],
      [
        {
          id: 51,
          identifier: "F1",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 52,
          identifier: "F2",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 53,
          identifier: "F3",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 54,
          identifier: "F4",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 55,
          identifier: "F5",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 56,
          identifier: "F6",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 57,
          identifier: "F7",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 58,
          identifier: "F8",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 59,
          identifier: "F9",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
        {
          id: 60,
          identifier: "F10",
          tire: "Platinum",
          clickable: true,
          selected: false,
        },
      ],
    ],
    totlaPrice: 0,
    count: 0,
    selected_seats_array: [],
  },
  reducers: {
    setSeatsData: (state, action) => {
      state.seatData.map((row, rIndex) => {
        row.map((seat, sIndex) => {
          if (
            action.payload.rowIndex === rIndex &&
            action.payload.seatIndex === sIndex
          ) {
            let newArray = state.seatData;
            if (newArray[rIndex][sIndex].selected === false) {
              newArray[rIndex][sIndex] = {
                ...seat,
                selected: true,
              };
              state.count++;
              state.selected_seats_array.push(seat);
              state.totlaPrice =
                state.totlaPrice +
                (newArray[rIndex][sIndex].tire === "Silver"
                  ? 100
                  : newArray[rIndex][sIndex].tire === "Gold"
                  ? 150
                  : 200);
            } else {
              newArray[rIndex][sIndex] = {
                ...seat,
                selected: false,
              };
              state.count--;
              state.totlaPrice =
                state.totlaPrice -
                (newArray[rIndex][sIndex].tire === "Silver"
                  ? 100
                  : newArray[rIndex][sIndex].tire === "Gold"
                  ? 150
                  : 200);
            }
          }
        });
      });
    },
    addCount: (state, action) => {
      console.log("1---6", state, action.payload);
      state.count++;
    },
    substractCount: (state, action) => {
      console.log("1---5", state, action.payload);

      state.count--;
    },

    updateSelectedTicket: (state, action) => {
      state.selected_seats_array = action.payload.updatedArray;
    },
    updateSeatData: (state, action) => {
      state.seatData.map((row, rIndex) => {
        row.map((seat, sIndex) => {
          if (
            action.payload.rowIndex === rIndex &&
            action.payload.seatIndex === sIndex
          ) {
            let newArray = state.seatData;
            if (newArray[rIndex][sIndex].selected === false) {
              newArray[rIndex][sIndex] = {
                ...seat,
                selected: true,
              };
            } else {
              newArray[rIndex][sIndex] = {
                ...seat,
                selected: false,
              };
            }
          }
        });
      });
    },

    updateTotalPrice: (state, action) => {
      state.totlaPrice = action.payload.price;
    },
  },
});

export const {
  setSeatsData,
  addCount,
  substractCount,
  updateSelectedTicket,
  updateSeatData,
  updateTotalPrice,
} = bookingSlice.actions;

export default bookingSlice.reducer;
